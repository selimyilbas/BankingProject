<div class="exchange-rates-container">
  <div class="page-header">
    <h1>Döviz Kurları</h1>
    <button (click)="refreshRates()" class="refresh-btn" [disabled]="loading">
      <i class="fas fa-sync-alt" [class.spinning]="loading"></i>
      Yenile
    </button>
  </div>

  <div class="rates-info">
    <p>Güncel döviz kurları ve çapraz kurlar.</p>
    <div class="last-updated" *ngIf="lastUpdated && !loading">
      <i class="fas fa-clock"></i>
      Son güncelleme: {{ lastUpdated | date:'dd.MM.yyyy HH:mm:ss' }}
    </div>
  </div>

  <div class="loading-container" *ngIf="loading">
    <div class="vakifbank-spinner"></div>
    <p>Döviz kurları yükleniyor...</p>
  </div>

  <div class="rates-grid" *ngIf="!loading">
    <div class="rate-card" *ngFor="let rate of exchangeRates">
      <div class="rate-header">
        <div class="currency-info">
          <span class="currency-code">{{ rate.currency }}</span>
          <span class="currency-name">{{ rate.currencyName }}</span>
        </div>
        <div class="currency-flag">
          <i class="fas fa-coins"></i>
        </div>
      </div>
      
      <div class="rate-details">
        <div class="rate-row">
          <div class="rate-type">
            <span class="label">Alış Kuru</span>
            <span class="sublabel">Banka Alış</span>
          </div>
          <div class="rate-value buy">
            <span class="value">{{ rate.buyRate | number:'1.4-4' }}</span>
            <span class="currency">₺</span>
            <span *ngIf="rate.buyDelta !== undefined" class="delta" [class.up]="(rate.buyDelta||0) > 0" [class.down]="(rate.buyDelta||0) < 0">
              <i class="fas" [class.fa-arrow-up]="(rate.buyDelta||0) > 0" [class.fa-arrow-down]="(rate.buyDelta||0) < 0"></i>
            {{ rate.buyDelta > 0 ? '+' : ''}}{{ rate.buyDelta | number:'1.4-4' }}
              <span class="delta-pct">({{ rate.buyDeltaPct! > 0 ? '+' : ''}}{{ rate.buyDeltaPct }}%)</span>
            </span>
          </div>
        </div>

        <div class="rate-row">
          <div class="rate-type">
            <span class="label">Satış Kuru</span>
            <span class="sublabel">Banka Satış</span>
          </div>
          <div class="rate-value sell">
            <span class="value">{{ rate.sellRate | number:'1.4-4' }}</span>
            <span class="currency">₺</span>
            <span *ngIf="rate.sellDelta !== undefined" class="delta" [class.up]="(rate.sellDelta||0) > 0" [class.down]="(rate.sellDelta||0) < 0">
              <i class="fas" [class.fa-arrow-up]="(rate.sellDelta||0) > 0" [class.fa-arrow-down]="(rate.sellDelta||0) < 0"></i>
            {{ rate.sellDelta > 0 ? '+' : ''}}{{ rate.sellDelta | number:'1.4-4' }}
              <span class="delta-pct">({{ rate.sellDeltaPct! > 0 ? '+' : ''}}{{ rate.sellDeltaPct }}%)</span>
            </span>
          </div>
        </div>

        <div class="rate-spread">
          <span class="spread-label">Spread:</span>
          <span class="spread-value">{{ (rate.sellRate - rate.buyRate) | number:'1.4-4' }} ₺</span>
        </div>
      </div>
    </div>
  </div>

  <div class="disclaimer" *ngIf="!loading">
    <p><i class="fas fa-info-circle"></i> Kurlar sayfa açıldığında yüklenir. "Yenile" düğmesine basarak güncel kurları isteyebilirsiniz.</p>
  </div>

  <!-- Kripto Kurları (Top 15) kısa liste -->
  <div class="page-header" style="margin-top: 24px;">
    <h2>Kripto Kurları (Top 15)</h2>
  </div>
  <div class="loading-container" *ngIf="cryptoLoading">
    <div class="vakifbank-spinner"></div>
    <p>Kripto kurları yükleniyor...</p>
  </div>
  <div class="rates-grid" *ngIf="!cryptoLoading">
    <div class="rate-card" *ngFor="let c of topCrypto">
      <div class="rate-header">
        <div class="currency-info">
          <span class="currency-code">{{ c.symbol }}</span>
          <span class="currency-name">Kaynak: Binance</span>
        </div>
        <div class="currency-flag">
          <i class="fas fa-coins"></i>
        </div>
      </div>
      <div class="rate-details">
        <div class="rate-row">
          <div class="rate-type">
            <span class="label">Fiyat</span>
            <span class="sublabel">USDT</span>
          </div>
          <div class="rate-value buy">
            <span class="value">{{ c.lastPrice | number:'1.6-6' }}</span>
          </div>
        </div>
        <div class="rate-row">
          <div class="rate-type">
            <span class="label">24s%</span>
          </div>
          <div class="rate-value" [ngStyle]="{color: (c.priceChangePercent||0) >= 0 ? 'green' : 'red'}">
            <span class="value">{{ c.priceChangePercent | number:'1.2-2' }}%</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>